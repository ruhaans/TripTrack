{% extends "base.html" %}
{% block title %}Trips Â· TripTrack{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto space-y-6 animate-fade-in">
  <header class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <div>
      <h1 class="text-3xl font-heading font-bold text-slate-900 dark:text-slate-100">All Trips</h1>
      <p class="mt-1 text-slate-600 dark:text-slate-400">Create, activate, edit, or delete trips.</p>
    </div>
    <div class="flex-shrink-0">
      <a href="{% url 'trips:trip-create' %}" class="inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-brand-500 to-brand-600 text-white px-5 py-2.5 font-semibold text-sm shadow-button hover:shadow-lg hover:-translate-y-0.5 tween">
        Create New Trip
      </a>
    </div>
  </header>

  <div class="rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800/50 shadow-xl dark:shadow-2xl">
    
    <div class="p-4 space-y-4 md:hidden">
      {% for t in trips %}
        <div class="rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 p-4">
          <div class="flex items-start justify-between gap-4">
            <div>
              <h2 class="font-semibold text-slate-900 dark:text-slate-100">{{ t.name }}</h2>
              <p class="text-xs text-slate-500 dark:text-slate-400">Capacity: {{ t.capacity }}</p>
            </div>
            {% if t.is_active %}
              <span class="inline-flex items-center gap-1.5 text-xs px-2.5 py-1 rounded-full bg-emerald-100 dark:bg-emerald-900/50 text-emerald-800 dark:text-emerald-300 font-medium shrink-0"><span class="h-2 w-2 rounded-full bg-emerald-500"></span> Active</span>
            {% else %}
              <span class="inline-flex items-center text-xs px-2.5 py-1 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 font-medium shrink-0">Inactive</span>
            {% endif %}
          </div>
          <div class="mt-3 pt-3 border-t border-slate-200 dark:border-slate-700 text-sm text-slate-600 dark:text-slate-300">
            <div><strong>Date:</strong> {{ t.date|date:"D, d M Y" }}</div>
            <div><strong>Pickup:</strong> {{ t.pickup_point }}</div>
          </div>
          <div class="mt-3 pt-3 border-t border-slate-200 dark:border-slate-700 flex items-center justify-end gap-2">
            {% if not t.is_active %}
              <a href="{% url 'trips:trip-set-active' t.id %}" class="px-3 py-1.5 rounded-lg bg-brand-500 hover:bg-brand-600 text-white text-xs font-semibold tween">Make active</a>
            {% endif %}
            <a href="{% url 'trips:trip-edit' t.id %}" class="px-3 py-1.5 rounded-lg border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 text-xs font-semibold tween">Edit</a>
            <form method="post" action="{% url 'trips:trip-delete' t.id %}" onsubmit="return confirm('Delete this trip? This cannot be undone.');">{% csrf_token %}<button type="submit" class="px-3 py-1.5 rounded-lg border border-red-200 dark:border-red-500/30 text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 text-xs font-semibold tween">Delete</button></form>
          </div>
        </div>
      {% empty %}
        <div class="py-10 text-center">
          <p class="text-slate-500 dark:text-slate-400">No trips have been created yet.</p>
          <a href="{% url 'trips:trip-create' %}" class="mt-4 inline-flex items-center rounded-xl bg-brand-500 hover:bg-brand-600 text-white px-5 py-3 font-medium shadow-button hover:shadow-lg tween">Create Your First Trip</a>
        </div>
      {% endfor %}
    </div>

    <div class="hidden md:block overflow-x-auto">
      <table class="min-w-full text-sm">
        <thead class="bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400">
          <tr class="text-left border-b border-slate-200 dark:border-slate-700">
            <th class="py-3 px-4 font-semibold">Name</th>
            <th class="py-3 px-4 font-semibold">Date</th>
            <th class="py-3 px-4 font-semibold">Pickup</th>
            <th class="py-3 px-4 font-semibold">Capacity</th>
            <th class="py-3 px-4 font-semibold">Status</th>
            <th class="py-3 px-4 font-semibold text-right">Actions</th>
          </tr>
        </thead>
        <tbody class="text-slate-800 dark:text-slate-200">
        {% for t in trips %}
          <tr class="border-t border-slate-200 dark:border-slate-700 hover:bg-slate-50/70 dark:hover:bg-slate-700/50">
            <td class="py-3 px-4 font-medium text-slate-900 dark:text-white">{{ t.name }}</td>
            <td class="py-3 px-4">{{ t.date|date:"D, d M Y" }}</td>
            <td class="py-3 px-4">{{ t.pickup_point }}</td>
            <td class="py-3 px-4">{{ t.capacity }}</td>
            <td class="py-3 px-4">
              {% if t.is_active %}
                <span class="inline-flex items-center gap-1.5 text-xs px-2.5 py-1 rounded-full bg-emerald-100 dark:bg-emerald-900/50 text-emerald-800 dark:text-emerald-300 font-medium"><span class="h-2 w-2 rounded-full bg-emerald-500"></span> Active</span>
              {% else %}
                <span class="inline-flex items-center text-xs px-2.5 py-1 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 font-medium">Inactive</span>
              {% endif %}
            </td>
            <td class="py-3 px-4">
              <div class="flex items-center justify-end gap-2">
                {% if not t.is_active %}
                  <a href="{% url 'trips:trip-set-active' t.id %}" class="px-3 py-1.5 rounded-lg bg-brand-500 hover:bg-brand-600 text-white text-xs font-semibold tween">Make active</a>
                {% endif %}
                <a href="{% url 'trips:trip-edit' t.id %}" class="px-3 py-1.5 rounded-lg border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 text-xs font-semibold tween">Edit</a>
                <form method="post" action="{% url 'trips:trip-delete' t.id %}" onsubmit="return confirm('Delete this trip? This cannot be undone.');">{% csrf_token %}<button type="submit" class="px-3 py-1.5 rounded-lg border border-red-200 dark:border-red-500/30 text-red-600 dark:text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 text-xs font-semibold tween">Delete</button></form>
              </div>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="6" class="py-10 px-4 text-center text-slate-500 dark:text-slate-400">
            No trips have been created yet. <a href="{% url 'trips:trip-create' %}" class="text-brand-600 dark:text-brand-400 font-semibold hover:underline">Create one now</a>.
          </td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}